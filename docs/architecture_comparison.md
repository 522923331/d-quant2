# é‡åŒ–äº¤æ˜“ç³»ç»Ÿæ¶æ„å¯¹æ¯”åˆ†ææŠ¥å‘Š

> **é‡è¦æç¤º**ï¼šæœ¬æŠ¥å‘Šç”¨äºæŒ‡å¯¼ d-quant2 ç³»ç»Ÿçš„å®Œå–„å’Œæ‰©å±•ã€‚ä»£ç å®ç°åŠ¡å¿…ä¸¥æ ¼å‚ç…§ç°æœ‰é¡¹ç›®çš„æˆç†Ÿæ¨¡å¼ï¼Œé¿å…å¼•å…¥ç¼ºé™·ã€‚

## ä¸€ã€é¡¹ç›®æ¦‚è§ˆ

### 1.1 åˆ†æçš„å››ä¸ªé‡åŒ–é¡¹ç›®

| é¡¹ç›®åç§° | æŠ€æœ¯æ ˆ | ç‰¹ç‚¹ | æˆç†Ÿåº¦ |
|---------|--------|------|--------|
| **QuantOL** | Python + FastAPI + PostgreSQL + Streamlit | ä¼ä¸šçº§æ¶æ„ï¼Œæ¨¡å—åŒ–ç¨‹åº¦æœ€é«˜ | â­â­â­â­â­ |
| **qstock** | Python + pandas | è½»é‡çº§ï¼Œä¸“æ³¨æ•°æ®å’Œå›æµ‹ | â­â­â­â­ |
| **OSkhQuant** | Python + PyQt5 + MyTT | æ¡Œé¢åº”ç”¨ï¼Œå¯è§†åŒ–å¼º | â­â­â­â­ |
| **sphinx-quant** | Django + React + Celery | Webåº”ç”¨ï¼Œæ”¯æŒå®ç›˜äº¤æ˜“ | â­â­â­â­â­ |
| **d-quant2** (å½“å‰) | Python + Streamlit | å›æµ‹ç³»ç»Ÿï¼Œéœ€è¦æ‰©å±• | â­â­â­ |

---

## äºŒã€æ ¸å¿ƒæ¨¡å—æ¶æ„å¯¹æ¯”

### 2.1 æ•°æ®æ¨¡å— (Data Module)

#### QuantOL çš„æ•°æ®æ¶æ„ â­â­â­â­â­
```
src/core/data/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ data_source.py              # æ•°æ®æºæŠ½è±¡åŸºç±»
â”œâ”€â”€ data_factory.py             # æ•°æ®æºå·¥å‚
â”œâ”€â”€ data_source_selector.py     # æ™ºèƒ½æ•°æ®æºé€‰æ‹©å™¨
â”œâ”€â”€ akshare_source.py           # AkShare æ•°æ®æº
â”œâ”€â”€ baostock_source.py          # Baostock æ•°æ®æº
â”œâ”€â”€ market_data_source.py       # å¸‚åœºæ•°æ®æº
â”œâ”€â”€ political_source.py         # æ”¿ç­–æ•°æ®æº
â”œâ”€â”€ database.py                 # æ•°æ®åº“æŠ½è±¡å±‚
â”œâ”€â”€ database_adapter.py         # æ•°æ®åº“é€‚é…å™¨
â”œâ”€â”€ database_factory.py         # æ•°æ®åº“å·¥å‚
â”œâ”€â”€ postgresql_adapter.py       # PostgreSQL é€‚é…å™¨
â”œâ”€â”€ sqlite_adapter.py           # SQLite é€‚é…å™¨
â”œâ”€â”€ smart_data_manager.py       # æ™ºèƒ½æ•°æ®ç®¡ç†å™¨
â”œâ”€â”€ field_mapper.py             # å­—æ®µæ˜ å°„å™¨
â”œâ”€â”€ adapters/                   # é€‚é…å™¨æ¨¡å—
â”œâ”€â”€ cache/                      # ç¼“å­˜ç®¡ç†
â”œâ”€â”€ config/                     # é…ç½®ç®¡ç†
â”œâ”€â”€ market_research/            # å¸‚åœºç ”ç©¶æ•°æ®
â””â”€â”€ transformers/               # æ•°æ®è½¬æ¢å™¨
```

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- âœ… **å¤šæ•°æ®æºæ”¯æŒ**ï¼šAkShare, Baostock, Tushare
- âœ… **æ•°æ®åº“æŒä¹…åŒ–**ï¼šPostgreSQL, SQLite
- âœ… **æ™ºèƒ½ç¼“å­˜æœºåˆ¶**ï¼šLRUç¼“å­˜ + ç£ç›˜ç¼“å­˜
- âœ… **å­—æ®µæ˜ å°„ç»Ÿä¸€**ï¼šä¸åŒæ•°æ®æºå­—æ®µè‡ªåŠ¨è½¬æ¢
- âœ… **æ•°æ®è´¨é‡æ£€æŸ¥**ï¼šå®Œæ•´æ€§ã€ä¸€è‡´æ€§éªŒè¯
- âœ… **å¢é‡æ›´æ–°**ï¼šåªä¸‹è½½ç¼ºå¤±æ•°æ®

#### qstock çš„æ•°æ®æ¶æ„ â­â­â­â­
```
data/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ trade.py                    # è¡Œæƒ…äº¤æ˜“æ•°æ®
â”œâ”€â”€ fundamental.py              # åŸºæœ¬é¢æ•°æ®
â”œâ”€â”€ industry.py                 # è¡Œä¸šæ¿å—æ•°æ®
â”œâ”€â”€ macro.py                    # å®è§‚ç»æµæ•°æ®
â”œâ”€â”€ money.py                    # èµ„é‡‘æµæ•°æ®
â”œâ”€â”€ news.py                     # æ–°é—»æ–‡æœ¬æ•°æ®
â”œâ”€â”€ wencai.py                   # é—®è´¢æ•°æ®æ¥å£
â””â”€â”€ util.py                     # å·¥å…·å‡½æ•°
```

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- âœ… **ä¸°å¯Œçš„æ•°æ®æ¥å£**ï¼šæ¶µç›–å¤šç»´åº¦æ•°æ®
- âœ… **é—®è´¢é›†æˆ**ï¼šæ”¯æŒè‡ªç„¶è¯­è¨€é€‰è‚¡
- âœ… **å®æ—¶æ•°æ®**ï¼šæ”¯æŒå®æ—¶è¡Œæƒ…è·å–

#### d-quant2 å½“å‰æ•°æ®æ¶æ„ â­â­â­
```
dquant2/core/data/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ interface.py                # æ•°æ®æ¥å£
â”œâ”€â”€ manager.py                  # æ•°æ®ç®¡ç†å™¨
â”œâ”€â”€ downloader.py               # æ•°æ®ä¸‹è½½å™¨
â”œâ”€â”€ cache.py                    # Parquet ç¼“å­˜
â”œâ”€â”€ providers/                  # æ•°æ®æä¾›è€…
â”‚   â”œâ”€â”€ base.py
â”‚   â”œâ”€â”€ akshare_provider.py
â”‚   â””â”€â”€ baostock_provider.py
â”œâ”€â”€ stock_lists/                # è‚¡ç¥¨åˆ—è¡¨
â”‚   â””â”€â”€ stock_list_manager.py
â”œâ”€â”€ download/                   # æ‰¹é‡ä¸‹è½½
â”‚   â””â”€â”€ batch_downloader.py
â””â”€â”€ storage/                    # å­˜å‚¨ç®¡ç†
```

**ç¼ºå¤±åŠŸèƒ½**ï¼š
- âŒ ç¼ºå°‘æ•°æ®åº“æŒä¹…åŒ–
- âŒ ç¼ºå°‘å­—æ®µæ˜ å°„æœºåˆ¶
- âŒ ç¼ºå°‘æ•°æ®è´¨é‡æ£€æŸ¥
- âŒ ç¼ºå°‘æ™ºèƒ½æ•°æ®æºé€‰æ‹©å™¨
- âŒ ç¼ºå°‘åŸºæœ¬é¢æ•°æ®æ¥å£
- âŒ ç¼ºå°‘å®è§‚æ•°æ®æ¥å£

---

### 2.2 å›æµ‹æ¨¡å— (Backtest Module)

#### QuantOL çš„å›æµ‹æ¶æ„ â­â­â­â­â­
```
src/core/strategy/
â”œâ”€â”€ backtesting.py              # å›æµ‹å¼•æ“ï¼ˆ1800+ è¡Œï¼‰
â”œâ”€â”€ strategy.py                 # ç­–ç•¥åŸºç±»
â”œâ”€â”€ rule_based_strategy.py      # åŸºäºè§„åˆ™çš„ç­–ç•¥
â”œâ”€â”€ rule_parser.py              # è§„åˆ™è§£æå™¨ï¼ˆ1200+ è¡Œï¼‰
â”œâ”€â”€ fixed_percent_position_strategy.py  # å›ºå®šæ¯”ä¾‹ä»“ä½ç­–ç•¥
â”œâ”€â”€ dca_strategy.py             # å®šæŠ•ç­–ç•¥
â”œâ”€â”€ position_strategy.py        # ä»“ä½ç­–ç•¥
â”œâ”€â”€ indicators.py               # æŒ‡æ ‡è®¡ç®—
â”œâ”€â”€ signal_types.py             # ä¿¡å·ç±»å‹
â”œâ”€â”€ trade_order.py              # äº¤æ˜“è®¢å•
â”œâ”€â”€ event_handlers.py           # äº‹ä»¶å¤„ç†å™¨
â””â”€â”€ factor_precompute.py        # å› å­é¢„è®¡ç®—
```

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- âœ… **äº‹ä»¶é©±åŠ¨æ¶æ„**ï¼šåŸºäºäº‹ä»¶æ€»çº¿
- âœ… **è§„åˆ™å¼•æ“**ï¼šæ”¯æŒDSLè¡¨è¾¾å¼ï¼ˆå¦‚ "MA(5) > MA(20)"ï¼‰
- âœ… **å¤šç­–ç•¥æ”¯æŒ**ï¼šç­–ç•¥ç»„åˆã€ç­–ç•¥åˆ‡æ¢
- âœ… **å®æ—¶å›æµ‹**ï¼šæ”¯æŒåŠ¨æ€æ•°æ®æ³¨å…¥
- âœ… **è¯¦ç»†çš„æ€§èƒ½åˆ†æ**ï¼šå¤æ™®ã€ç´¢æè¯ºã€æœ€å¤§å›æ’¤ã€èƒœç‡ç­‰
- âœ… **ä»“ä½ç®¡ç†**ï¼šå›ºå®šæ¯”ä¾‹ã€åŠ¨æ€è°ƒæ•´ã€å‡¯åˆ©å…¬å¼

#### qstock çš„å›æµ‹æ¶æ„ â­â­â­â­
```
backtest/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ vec_backtest.py             # å‘é‡åŒ–å›æµ‹ï¼ˆåŸºäº pandasï¼‰
â”œâ”€â”€ bt_backtest.py              # åŸºäº backtrader æ¡†æ¶
â””â”€â”€ turtle.py                   # æµ·é¾Ÿç­–ç•¥ç¤ºä¾‹
```

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- âœ… **å‘é‡åŒ–å›æµ‹**ï¼šé€Ÿåº¦å¿«ï¼Œé€‚åˆç®€å•ç­–ç•¥
- âœ… **backtrader é›†æˆ**ï¼šæ”¯æŒå¤æ‚ç­–ç•¥
- âœ… **æµ·é¾Ÿäº¤æ˜“æ³•åˆ™**ï¼šç»å…¸ç­–ç•¥å®ç°

#### d-quant2 å½“å‰å›æµ‹æ¶æ„ â­â­â­
```
dquant2/backtest/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ config.py                   # å›æµ‹é…ç½®
â”œâ”€â”€ engine.py                   # å›æµ‹å¼•æ“
â””â”€â”€ metrics.py                  # æ€§èƒ½æŒ‡æ ‡
```

**ç¼ºå¤±åŠŸèƒ½**ï¼š
- âŒ ç¼ºå°‘è§„åˆ™å¼•æ“ï¼ˆDSLæ”¯æŒï¼‰
- âŒ ç¼ºå°‘äº‹ä»¶é©±åŠ¨æ¶æ„çš„å®Œæ•´å®ç°
- âŒ ç¼ºå°‘å¤šç­–ç•¥ç»„åˆ
- âŒ ç¼ºå°‘ç­–ç•¥å‚æ•°ä¼˜åŒ–
- âŒ ç¼ºå°‘æ»‘ç‚¹æ¨¡æ‹Ÿçš„å¤šç§æ¨¡å¼
- âŒ ç¼ºå°‘å®Œæ•´çš„è®¢å•ç±»å‹ï¼ˆå¸‚ä»·ã€é™ä»·ã€æ­¢æŸç­‰ï¼‰

---

### 2.3 æŠ•èµ„ç»„åˆæ¨¡å— (Portfolio Module)

#### QuantOL çš„æŠ•èµ„ç»„åˆæ¶æ„ â­â­â­â­â­
```
src/core/portfolio/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ portfolio_interface.py      # ç»„åˆæ¥å£ï¼ˆPosition æ•°æ®ç±»ï¼‰
â””â”€â”€ portfolio.py                # ç»„åˆç®¡ç†å™¨ï¼ˆ480+ è¡Œï¼‰
```

**æ ¸å¿ƒåŠŸèƒ½ï¼ˆportfolio.pyï¼‰**ï¼š
```python
class PortfolioManager(IPortfolio):
    """æŠ•èµ„ç»„åˆç®¡ç†ç±»
    
    èŒè´£ï¼š
    - ç®¡ç†æŠ•èµ„ç»„åˆçš„æŒä»“å’Œèµ„é‡‘çŠ¶æ€
    - è·Ÿè¸ªä»“ä½å˜åŒ–å’Œèµ„é‡‘å˜åŠ¨
    - è®¡ç®—ç»„åˆä»·å€¼å’Œæ”¶ç›ŠæŒ‡æ ‡
    - æ”¯æŒç»„åˆå†å¹³è¡¡è®¡ç®—
    - æä¾›æ€§èƒ½ä¼˜åŒ–çš„ç¼“å­˜æœºåˆ¶
    - ä¸TradeExecutionEngineååŒå·¥ä½œ
    """
    
    # æ ¸å¿ƒæ–¹æ³•ï¼š
    def update_position(symbol, quantity, price, commission)  # æ›´æ–°æŒä»“
    def get_portfolio_value()                                  # è·å–ç»„åˆä»·å€¼
    def get_position(symbol)                                   # è·å–æŒä»“
    def get_available_cash()                                   # è·å–å¯ç”¨èµ„é‡‘
    def calculate_rebalance()                                  # è®¡ç®—å†å¹³è¡¡
    def get_total_return()                                     # è®¡ç®—æ€»æ”¶ç›Š
    def get_positions_summary()                                # æŒä»“æ±‡æ€»
    def record_equity()                                        # è®°å½•å‡€å€¼
    def invalidate_cache()                                     # ç¼“å­˜ç®¡ç†
    def validate_position_update()                             # æŒä»“éªŒè¯
```

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- âœ… **ç¼“å­˜ä¼˜åŒ–**ï¼šLRUç¼“å­˜æå‡æ€§èƒ½
- âœ… **äº‹ä»¶å‘å¸ƒ**ï¼šæŒä»“æ›´æ–°è‡ªåŠ¨å‘å¸ƒäº‹ä»¶
- âœ… **å‡€å€¼è·Ÿè¸ª**ï¼šå®Œæ•´çš„å†å²å‡€å€¼è®°å½•
- âœ… **æœ€å¤§å›æ’¤è®¡ç®—**ï¼šå®æ—¶è®¡ç®—å’Œæ›´æ–°
- âœ… **å†å¹³è¡¡æ”¯æŒ**ï¼šç›®æ ‡æƒé‡è‡ªåŠ¨è°ƒæ•´
- âœ… **FIFOæˆæœ¬è®¡ç®—**ï¼šå…ˆè¿›å…ˆå‡ºåŸåˆ™

#### d-quant2 å½“å‰æŠ•èµ„ç»„åˆæ¶æ„ â­â­â­
```
dquant2/core/portfolio/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ manager.py                  # ç»„åˆç®¡ç†å™¨
â””â”€â”€ position.py                 # æŒä»“ç±»
```

**ç¼ºå¤±åŠŸèƒ½**ï¼š
- âŒ ç¼ºå°‘ç»„åˆå†å¹³è¡¡
- âŒ ç¼ºå°‘ç¼“å­˜ä¼˜åŒ–æœºåˆ¶
- âŒ ç¼ºå°‘å®Œæ•´çš„æˆæœ¬è®¡ç®—ï¼ˆFIFO/LIFOï¼‰
- âŒ ç¼ºå°‘äº‹ä»¶å‘å¸ƒæœºåˆ¶
- âŒ ç¼ºå°‘å¤šè´¦æˆ·ç®¡ç†

---

### 2.4 é£æ§æ¨¡å— (Risk Management Module)

#### QuantOL çš„é£æ§æ¶æ„ â­â­â­â­
```
src/core/risk/
â”œâ”€â”€ __init__.py
â””â”€â”€ risk_manager.py             # é£é™©ç®¡ç†å™¨
```

**æ ¸å¿ƒåŠŸèƒ½ï¼ˆrisk_manager.pyï¼‰**ï¼š
```python
class RiskManager:
    """é£é™©ç®¡ç†å™¨
    
    èŒè´£ï¼š
    - éªŒè¯è®¢å•æ˜¯å¦æ»¡è¶³é£é™©è¦æ±‚
    - æ£€æŸ¥å¯ç”¨èµ„é‡‘
    - æ£€æŸ¥ä»“ä½é™åˆ¶
    - ç›‘æ§é£é™©æŒ‡æ ‡
    """
    
    # æ ¸å¿ƒæ–¹æ³•ï¼š
    def validate_order(order_event)      # è®¢å•éªŒè¯
    def _check_funds(order_event)        # èµ„é‡‘æ£€æŸ¥
    def _check_position(order_event)     # ä»“ä½æ£€æŸ¥
```

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- âœ… **èµ„é‡‘æ£€æŸ¥**ï¼šä¹°å…¥å‰æ£€æŸ¥å¯ç”¨èµ„é‡‘
- âœ… **ä»“ä½é™åˆ¶**ï¼šå•åªè‚¡ç¥¨æŒä»“æ¯”ä¾‹é™åˆ¶
- âœ… **è®¢å•éªŒè¯**ï¼šå¤šç»´åº¦é£é™©æ£€æŸ¥

#### OSkhQuant çš„é£æ§æ¶æ„ â­â­â­
```
khRisk.py                       # é£æ§ç®¡ç†
```

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- âœ… **æ­¢æŸæ­¢ç›ˆ**ï¼šè‡ªåŠ¨æ­¢æŸæ­¢ç›ˆ
- âœ… **é£é™©é¢„è­¦**ï¼šå®æ—¶é£é™©ç›‘æ§

#### d-quant2 å½“å‰é£æ§æ¶æ„ â­â­
```
dquant2/core/risk/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ base.py                     # é£æ§åŸºç±»
â””â”€â”€ manager.py                  # é£æ§ç®¡ç†å™¨
```

**ç¼ºå¤±åŠŸèƒ½**ï¼š
- âŒ ç¼ºå°‘è®¢å•éªŒè¯æœºåˆ¶
- âŒ ç¼ºå°‘ä»“ä½é™åˆ¶æ£€æŸ¥
- âŒ ç¼ºå°‘é£é™©æŒ‡æ ‡ç›‘æ§ï¼ˆVaR, CVaR, Betaç­‰ï¼‰
- âŒ ç¼ºå°‘æ­¢æŸæ­¢ç›ˆè‡ªåŠ¨è§¦å‘
- âŒ ç¼ºå°‘èµ„é‡‘æ›²çº¿ä¿æŠ¤
- âŒ ç¼ºå°‘æœ€å¤§å›æ’¤æ§åˆ¶

---

### 2.5 äº¤æ˜“æ‰§è¡Œæ¨¡å— (Execution Module)

#### QuantOL çš„äº¤æ˜“æ‰§è¡Œæ¶æ„ â­â­â­â­â­
```
src/core/execution/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ Trader.py                   # äº¤æ˜“æ‰§è¡Œå™¨ï¼ˆ310+ è¡Œï¼‰
â”œâ”€â”€ ButtonDetector.py           # æŒ‰é’®æ£€æµ‹å™¨ï¼ˆå®ç›˜ï¼‰
â”œâ”€â”€ buy.png                     # ä¹°å…¥æŒ‰é’®å›¾åƒ
â”œâ”€â”€ sell.png                    # å–å‡ºæŒ‰é’®å›¾åƒ
â”œâ”€â”€ simbuy.png                  # æ¨¡æ‹Ÿä¹°å…¥æŒ‰é’®
â”œâ”€â”€ simbuyensure.png            # æ¨¡æ‹Ÿç¡®è®¤æŒ‰é’®
â”œâ”€â”€ sim_code.png                # æ¨¡æ‹Ÿä»£ç è¾“å…¥
â””â”€â”€ buttons_report.md           # æŒ‰é’®æ£€æµ‹æŠ¥å‘Š
```

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- âœ… **æ¨¡æ‹Ÿäº¤æ˜“**ï¼šå®Œæ•´çš„æ¨¡æ‹Ÿäº¤æ˜“å¼•æ“
- âœ… **å®ç›˜äº¤æ˜“**ï¼šæ”¯æŒå®ç›˜ä¸‹å•ï¼ˆé€šè¿‡å›¾åƒè¯†åˆ«ï¼‰
- âœ… **è®¢å•ç®¡ç†**ï¼šè®¢å•çŠ¶æ€è·Ÿè¸ª
- âœ… **æˆäº¤å›æŠ¥**ï¼šå®æ—¶æˆäº¤ç¡®è®¤

#### sphinx-quant çš„äº¤æ˜“æ‰§è¡Œæ¶æ„ â­â­â­â­â­
```
sphinxquant/api/
â”œâ”€â”€ models.py                   # äº¤æ˜“æ¨¡å‹
â”œâ”€â”€ tasks.py                    # Celery å¼‚æ­¥ä»»åŠ¡
â””â”€â”€ views.py                    # API è§†å›¾
```

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- âœ… **å¼‚æ­¥äº¤æ˜“**ï¼šCelery å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—
- âœ… **å®ç›˜å¯¹æ¥**ï¼šæ”¯æŒåˆ¸å•†API
- âœ… **è®¢å•ç›‘æ§**ï¼šå®æ—¶è®¢å•çŠ¶æ€è·Ÿè¸ª

#### d-quant2 å½“å‰äº¤æ˜“æ‰§è¡Œæ¶æ„ â­
```
dquant2/core/trading/
â”œâ”€â”€ __init__.py
â””â”€â”€ cost.py                     # äº¤æ˜“æˆæœ¬è®¡ç®—
```

**ç¼ºå¤±åŠŸèƒ½**ï¼š
- âŒ ç¼ºå°‘å®Œæ•´çš„è®¢å•ç®¡ç†ç³»ç»Ÿ
- âŒ ç¼ºå°‘è®¢å•çŠ¶æ€è·Ÿè¸ª
- âŒ ç¼ºå°‘æˆäº¤å›æŠ¥æœºåˆ¶
- âŒ ç¼ºå°‘æ»‘ç‚¹æ¨¡æ‹Ÿï¼ˆå¤šç§æ¨¡å¼ï¼‰
- âŒ ç¼ºå°‘é™ä»·å•ã€æ­¢æŸå•ç­‰è®¢å•ç±»å‹
- âŒ ç¼ºå°‘å®ç›˜äº¤æ˜“æ¥å£

---

### 2.6 äº‹ä»¶æ€»çº¿æ¨¡å— (Event Bus Module)

#### QuantOL çš„äº‹ä»¶æ€»çº¿æ¶æ„ â­â­â­â­â­
```
src/event_bus/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ event_bus.py                # äº‹ä»¶æ€»çº¿
â””â”€â”€ event_types.py              # äº‹ä»¶ç±»å‹å®šä¹‰
```

**äº‹ä»¶ç±»å‹**ï¼š
```python
# æ ¸å¿ƒäº‹ä»¶ç±»å‹
- BaseEvent                     # äº‹ä»¶åŸºç±»
- StrategySignalEvent           # ç­–ç•¥ä¿¡å·äº‹ä»¶
- OrderEvent                    # è®¢å•äº‹ä»¶
- FillEvent                     # æˆäº¤äº‹ä»¶
- PortfolioPositionUpdateEvent  # æŒä»“æ›´æ–°äº‹ä»¶
- StrategyScheduleEvent         # ç­–ç•¥å®šæ—¶äº‹ä»¶
- MarketDataEvent               # å¸‚åœºæ•°æ®äº‹ä»¶
```

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- âœ… **å‘å¸ƒ-è®¢é˜…æ¨¡å¼**ï¼šè§£è€¦å„æ¨¡å—
- âœ… **äº‹ä»¶é˜Ÿåˆ—**ï¼šå¼‚æ­¥äº‹ä»¶å¤„ç†
- âœ… **äº‹ä»¶å†å²**ï¼šäº‹ä»¶å›æ”¾å’Œå®¡è®¡
- âœ… **äº‹ä»¶è¿‡æ»¤**ï¼šæŒ‰ç±»å‹ã€ä¼˜å…ˆçº§è¿‡æ»¤

#### d-quant2 å½“å‰äº‹ä»¶æ€»çº¿æ¶æ„ â­â­â­
```
dquant2/core/event_bus/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ bus.py                      # äº‹ä»¶æ€»çº¿
â””â”€â”€ events.py                   # äº‹ä»¶ç±»å‹
```

**ç¼ºå¤±åŠŸèƒ½**ï¼š
- âŒ ç¼ºå°‘å®Œæ•´çš„äº‹ä»¶ç±»å‹ä½“ç³»
- âŒ ç¼ºå°‘äº‹ä»¶ä¼˜å…ˆçº§
- âŒ ç¼ºå°‘äº‹ä»¶æŒä¹…åŒ–
- âŒ ç¼ºå°‘äº‹ä»¶å›æ”¾åŠŸèƒ½

---

### 2.7 ç­–ç•¥æ¨¡å— (Strategy Module)

#### QuantOL çš„ç­–ç•¥æ¶æ„ â­â­â­â­â­
```
src/core/strategy/
â”œâ”€â”€ strategy.py                 # ç­–ç•¥åŸºç±»
â”œâ”€â”€ rule_based_strategy.py      # åŸºäºè§„åˆ™çš„ç­–ç•¥
â”œâ”€â”€ rule_parser.py              # è§„åˆ™è§£æå™¨ï¼ˆDSLï¼‰
â”œâ”€â”€ fixed_percent_position_strategy.py  # å›ºå®šæ¯”ä¾‹ç­–ç•¥
â”œâ”€â”€ dca_strategy.py             # å®šæŠ•ç­–ç•¥
â”œâ”€â”€ position_strategy.py        # ä»“ä½ç­–ç•¥
â”œâ”€â”€ indicators.py               # æŠ€æœ¯æŒ‡æ ‡
â””â”€â”€ signal_types.py             # ä¿¡å·ç±»å‹
```

**è§„åˆ™å¼•æ“ç¤ºä¾‹**ï¼š
```python
# æ”¯æŒè‡ªç„¶è¯­è¨€å¼çš„ç­–ç•¥è¡¨è¾¾å¼
buy_rule = "MA(5) > MA(20) and RSI(14) < 30"
sell_rule = "MA(5) < MA(20) or RSI(14) > 70"
```

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- âœ… **DSLè§„åˆ™å¼•æ“**ï¼šæ”¯æŒè¡¨è¾¾å¼ç­–ç•¥
- âœ… **ç­–ç•¥ç»„åˆ**ï¼šå¤šç­–ç•¥å¹¶è¡Œ
- âœ… **å®šæŠ•ç­–ç•¥**ï¼šæ”¯æŒå®šæœŸå®šé¢æŠ•èµ„
- âœ… **ä»“ä½ç­–ç•¥**ï¼šåŠ¨æ€ä»“ä½ç®¡ç†
- âœ… **äº‹ä»¶å›è°ƒ**ï¼šon_bar, on_schedule, on_order ç­‰

#### d-quant2 å½“å‰ç­–ç•¥æ¶æ„ â­â­â­
```
dquant2/core/strategy/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ base.py                     # ç­–ç•¥åŸºç±»
â”œâ”€â”€ factory.py                  # ç­–ç•¥å·¥å‚
â”œâ”€â”€ hypothesis/                 # å‡è®¾ç­–ç•¥
â”‚   â”œâ”€â”€ ma_cross.py
â”‚   â”œâ”€â”€ rsi_strategy.py
â”‚   â”œâ”€â”€ macd_strategy.py
â”‚   â”œâ”€â”€ bollinger_strategy.py
â”‚   â””â”€â”€ ma_rsi_mytt.py
â””â”€â”€ custom/                     # è‡ªå®šä¹‰ç­–ç•¥
    â”œâ”€â”€ custom_template.py
    â””â”€â”€ ma_rsi_combo.py
```

**ç¼ºå¤±åŠŸèƒ½**ï¼š
- âŒ ç¼ºå°‘è§„åˆ™å¼•æ“ï¼ˆDSLï¼‰
- âŒ ç¼ºå°‘ç­–ç•¥ç»„åˆæ¡†æ¶
- âŒ ç¼ºå°‘å®šæŠ•ç­–ç•¥
- âŒ ç¼ºå°‘ç­–ç•¥å‚æ•°ä¼˜åŒ–
- âŒ ç¼ºå°‘ç­–ç•¥è¯„åˆ†æœºåˆ¶
- âŒ ç¼ºå°‘ç­–ç•¥å›æµ‹å¯¹æ¯”

---

### 2.8 èµ„é‡‘ç®¡ç†æ¨¡å— (Capital Management Module)

#### d-quant2 å½“å‰èµ„é‡‘ç®¡ç†æ¶æ„ â­â­â­â­
```
dquant2/core/capital/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ base.py                     # èµ„é‡‘ç®¡ç†åŸºç±»
â”œâ”€â”€ fixed_ratio.py              # å›ºå®šæ¯”ä¾‹
â””â”€â”€ kelly.py                    # å‡¯åˆ©å…¬å¼
```

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- âœ… **å›ºå®šæ¯”ä¾‹**ï¼šæŒ‰å›ºå®šæ¯”ä¾‹åˆ†é…èµ„é‡‘
- âœ… **å‡¯åˆ©å…¬å¼**ï¼šåŠ¨æ€èµ„é‡‘åˆ†é…

**å¯æ‰©å±•åŠŸèƒ½**ï¼š
- ğŸ”§ é©¬ä¸æ ¼å°”èµ„é‡‘ç®¡ç†
- ğŸ”§ åé©¬ä¸æ ¼å°”èµ„é‡‘ç®¡ç†
- ğŸ”§ å›ºå®šé‡‘é¢èµ„é‡‘ç®¡ç†
- ğŸ”§ ç™¾åˆ†æ¯”é£é™©èµ„é‡‘ç®¡ç†

---

## ä¸‰ã€æ¶æ„å…±æ€§æ€»ç»“

### 3.1 æ ¸å¿ƒæ¨¡å—å…±æ€§

æ‰€æœ‰æˆç†Ÿçš„é‡åŒ–ç³»ç»Ÿéƒ½åŒ…å«ä»¥ä¸‹æ ¸å¿ƒæ¨¡å—ï¼š

| æ¨¡å— | QuantOL | qstock | OSkhQuant | sphinx-quant | d-quant2 |
|------|---------|--------|-----------|--------------|----------|
| **æ•°æ®æ¨¡å—** | âœ… å®Œå–„ | âœ… å®Œå–„ | âœ… å®Œå–„ | âœ… å®Œå–„ | âš ï¸ åŸºç¡€ |
| **å›æµ‹æ¨¡å—** | âœ… å®Œå–„ | âœ… å®Œå–„ | âœ… å®Œå–„ | âœ… å®Œå–„ | âš ï¸ åŸºç¡€ |
| **ç­–ç•¥æ¨¡å—** | âœ… å®Œå–„ | âœ… å®Œå–„ | âœ… å®Œå–„ | âœ… å®Œå–„ | âš ï¸ åŸºç¡€ |
| **æŠ•èµ„ç»„åˆ** | âœ… å®Œå–„ | âœ… å®Œå–„ | âœ… å®Œå–„ | âœ… å®Œå–„ | âš ï¸ åŸºç¡€ |
| **é£æ§æ¨¡å—** | âœ… å®Œå–„ | âš ï¸ åŸºç¡€ | âœ… å®Œå–„ | âœ… å®Œå–„ | âŒ ç¼ºå¤± |
| **äº¤æ˜“æ‰§è¡Œ** | âœ… å®Œå–„ | âŒ ä»…å›æµ‹ | âœ… å®ç›˜ | âœ… å®ç›˜ | âŒ ç¼ºå¤± |
| **äº‹ä»¶æ€»çº¿** | âœ… å®Œå–„ | âŒ æ—  | âš ï¸ ç®€å• | âœ… å®Œå–„ | âš ï¸ åŸºç¡€ |
| **å¯è§†åŒ–** | âœ… Streamlit | âœ… Web | âœ… PyQt5 | âœ… React | âœ… Streamlit |

### 3.2 è®¾è®¡æ¨¡å¼å…±æ€§

#### 3.2.1 äº‹ä»¶é©±åŠ¨æ¶æ„ï¼ˆEvent-Driven Architectureï¼‰
- **QuantOL**: å®Œæ•´çš„äº‹ä»¶æ€»çº¿ï¼Œæ”¯æŒå¤šç§äº‹ä»¶ç±»å‹
- **sphinx-quant**: åŸºäº Celery çš„å¼‚æ­¥äº‹ä»¶å¤„ç†
- **d-quant2**: åŸºç¡€äº‹ä»¶æ€»çº¿ï¼Œéœ€è¦æ‰©å±•

#### 3.2.2 æ¨¡å—åŒ–è®¾è®¡ï¼ˆModular Designï¼‰
- æ‰€æœ‰é¡¹ç›®éƒ½é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡
- æ ¸å¿ƒæ¨¡å—ï¼šæ•°æ®ã€ç­–ç•¥ã€å›æµ‹ã€ç»„åˆã€é£æ§ã€æ‰§è¡Œ

#### 3.2.3 ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰
- ç­–ç•¥åŸºç±» + å…·ä½“ç­–ç•¥å®ç°
- ç­–ç•¥å·¥å‚æ¨¡å¼åˆ›å»ºç­–ç•¥å®ä¾‹
- æ”¯æŒç­–ç•¥çƒ­æ’æ‹”

#### 3.2.4 å·¥å‚æ¨¡å¼ï¼ˆFactory Patternï¼‰
- æ•°æ®æºå·¥å‚
- ç­–ç•¥å·¥å‚
- æ•°æ®åº“é€‚é…å™¨å·¥å‚

#### 3.2.5 é€‚é…å™¨æ¨¡å¼ï¼ˆAdapter Patternï¼‰
- æ•°æ®æºé€‚é…å™¨ï¼šç»Ÿä¸€ä¸åŒæ•°æ®æºæ¥å£
- æ•°æ®åº“é€‚é…å™¨ï¼šæ”¯æŒå¤šç§æ•°æ®åº“
- åˆ¸å•†æ¥å£é€‚é…å™¨ï¼šç»Ÿä¸€åˆ¸å•†API

---

## å››ã€d-quant2 éœ€è¦å®Œå–„çš„æ¨¡å—

### 4.1 ä¼˜å…ˆçº§ P0ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼Œå¿…é¡»å®Œæˆï¼‰

#### 4.1.1 å®Œå–„é£æ§æ¨¡å— â­â­â­â­â­
**å‚è€ƒé¡¹ç›®**: QuantOL

**éœ€è¦å®ç°çš„åŠŸèƒ½**ï¼š
1. **è®¢å•éªŒè¯æœºåˆ¶**
   - èµ„é‡‘å……è¶³æ€§æ£€æŸ¥
   - ä»“ä½æ¯”ä¾‹æ£€æŸ¥
   - æŒä»“æ•°é‡é™åˆ¶

2. **é£é™©æŒ‡æ ‡ç›‘æ§**
   - å®æ—¶è®¡ç®— VaRï¼ˆé£é™©ä»·å€¼ï¼‰
   - å®æ—¶è®¡ç®— CVaRï¼ˆæ¡ä»¶é£é™©ä»·å€¼ï¼‰
   - å®æ—¶è®¡ç®— Betaï¼ˆå¸‚åœºç›¸å…³æ€§ï¼‰
   - å®æ—¶è®¡ç®—æœ€å¤§å›æ’¤

3. **æ­¢æŸæ­¢ç›ˆæœºåˆ¶**
   - å›ºå®šæ­¢æŸ/æ­¢ç›ˆ
   - ç§»åŠ¨æ­¢æŸ/æ­¢ç›ˆ
   - æ—¶é—´æ­¢æŸ

**å®ç°å»ºè®®**ï¼š
```python
# å‚è€ƒ QuantOL/src/core/risk/risk_manager.py
class RiskManager:
    def __init__(self, portfolio, config):
        self.portfolio = portfolio
        self.config = config
        self.max_position_ratio = config.max_position_ratio
        self.max_loss_ratio = config.max_loss_ratio
        
    def validate_order(self, order_event):
        """è®¢å•éªŒè¯"""
        if not self._check_funds(order_event):
            return False, "èµ„é‡‘ä¸è¶³"
        if not self._check_position_limit(order_event):
            return False, "è¶…è¿‡ä»“ä½é™åˆ¶"
        if not self._check_risk_metrics(order_event):
            return False, "é£é™©æŒ‡æ ‡è¶…é™"
        return True, "éªŒè¯é€šè¿‡"
```

#### 4.1.2 å®Œå–„æŠ•èµ„ç»„åˆæ¨¡å— â­â­â­â­â­
**å‚è€ƒé¡¹ç›®**: QuantOL

**éœ€è¦å®ç°çš„åŠŸèƒ½**ï¼š
1. **ç¼“å­˜ä¼˜åŒ–æœºåˆ¶**
   - LRUç¼“å­˜ç»„åˆä»·å€¼è®¡ç®—
   - ç¼“å­˜å¤±æ•ˆç­–ç•¥

2. **æˆæœ¬è®¡ç®—**
   - FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰
   - LIFOï¼ˆåè¿›å…ˆå‡ºï¼‰
   - åŠ æƒå¹³å‡æˆæœ¬

3. **ç»„åˆå†å¹³è¡¡**
   - ç›®æ ‡æƒé‡è°ƒæ•´
   - æœ€å°äº¤æ˜“æˆæœ¬è·¯å¾„

**å®ç°å»ºè®®**ï¼š
```python
# å‚è€ƒ QuantOL/src/core/portfolio/portfolio.py
class PortfolioManager:
    def __init__(self, initial_capital, position_strategy, event_bus=None):
        self.initial_capital = initial_capital
        self.current_cash = initial_capital
        self.positions = {}
        self.equity_history = []
        self._peak_value = initial_capital
        self._max_drawdown = 0.0
        # ç¼“å­˜
        self._portfolio_value_cache = None
        self._cache_timestamp = 0
        self._cache_ttl = 1.0
        
    def update_position(self, symbol, quantity, price, commission=0.0):
        """æ›´æ–°æŒä»“ï¼ˆFIFOæˆæœ¬è®¡ç®—ï¼‰"""
        # å®ç° FIFO æˆæœ¬è®¡ç®—é€»è¾‘
        pass
        
    def get_portfolio_value(self):
        """è·å–ç»„åˆä»·å€¼ï¼ˆå¸¦ç¼“å­˜ï¼‰"""
        import time
        current_time = time.time()
        if (self._portfolio_value_cache is not None and 
            current_time - self._cache_timestamp < self._cache_ttl):
            return self._portfolio_value_cache
        
        # è®¡ç®—ç»„åˆä»·å€¼
        total_value = self.current_cash
        for position in self.positions.values():
            total_value += position.current_value
        
        # æ›´æ–°ç¼“å­˜
        self._portfolio_value_cache = total_value
        self._cache_timestamp = current_time
        return total_value
```

#### 4.1.3 å®Œå–„æ•°æ®æ¨¡å— â­â­â­â­â­
**å‚è€ƒé¡¹ç›®**: QuantOL, qstock

**éœ€è¦å®ç°çš„åŠŸèƒ½**ï¼š
1. **æ•°æ®åº“æŒä¹…åŒ–**
   - SQLite é€‚é…å™¨
   - PostgreSQL é€‚é…å™¨ï¼ˆå¯é€‰ï¼‰

2. **å­—æ®µæ˜ å°„å™¨**
   - ç»Ÿä¸€ä¸åŒæ•°æ®æºçš„å­—æ®µå
   - è‡ªåŠ¨ç±»å‹è½¬æ¢

3. **æ•°æ®è´¨é‡æ£€æŸ¥**
   - å®Œæ•´æ€§æ£€æŸ¥
   - ä¸€è‡´æ€§æ£€æŸ¥
   - å¼‚å¸¸å€¼æ£€æµ‹

4. **åŸºæœ¬é¢æ•°æ®**
   - è´¢åŠ¡æŠ¥è¡¨æ•°æ®
   - ä¼°å€¼æŒ‡æ ‡æ•°æ®

**å®ç°å»ºè®®**ï¼š
```python
# å‚è€ƒ QuantOL/src/core/data/sqlite_adapter.py
class SQLiteAdapter:
    def __init__(self, db_path):
        self.db_path = db_path
        self.conn = None
        
    def save_kline_data(self, symbol, df):
        """ä¿å­˜Kçº¿æ•°æ®"""
        pass
        
    def load_kline_data(self, symbol, start_date, end_date):
        """åŠ è½½Kçº¿æ•°æ®"""
        pass
```

#### 4.1.4 æ‰©å±•å›æµ‹å¼•æ“ â­â­â­â­
**å‚è€ƒé¡¹ç›®**: QuantOL

**éœ€è¦å®ç°çš„åŠŸèƒ½**ï¼š
1. **è®¢å•ç±»å‹æ‰©å±•**
   - å¸‚ä»·å•
   - é™ä»·å•
   - æ­¢æŸå•
   - æ­¢ç›ˆå•

2. **æ»‘ç‚¹æ¨¡æ‹Ÿæ‰©å±•**
   - å›ºå®šæ»‘ç‚¹
   - æ¯”ä¾‹æ»‘ç‚¹
   - åŠ¨æ€æ»‘ç‚¹ï¼ˆåŸºäºæˆäº¤é‡ï¼‰

3. **ç­–ç•¥å‚æ•°ä¼˜åŒ–**
   - ç½‘æ ¼æœç´¢
   - éšæœºæœç´¢
   - é—ä¼ ç®—æ³•

**å®ç°å»ºè®®**ï¼š
```python
# æ‰©å±•è®¢å•ç±»å‹
class Order:
    def __init__(self, symbol, quantity, order_type='MARKET', 
                 limit_price=None, stop_price=None):
        self.symbol = symbol
        self.quantity = quantity
        self.order_type = order_type  # MARKET, LIMIT, STOP, STOP_LIMIT
        self.limit_price = limit_price
        self.stop_price = stop_price
```

---

### 4.2 ä¼˜å…ˆçº§ P1ï¼ˆé‡è¦åŠŸèƒ½ï¼Œæ¨èå®Œæˆï¼‰

#### 4.2.1 è§„åˆ™å¼•æ“ï¼ˆDSLï¼‰â­â­â­â­
**å‚è€ƒé¡¹ç›®**: QuantOL

**éœ€è¦å®ç°çš„åŠŸèƒ½**ï¼š
1. **è¡¨è¾¾å¼è§£æå™¨**
   - æ”¯æŒ MA, RSI, MACD, BOLL ç­‰æŒ‡æ ‡
   - æ”¯æŒé€»è¾‘è¿ç®—ç¬¦ï¼ˆand, or, notï¼‰
   - æ”¯æŒæ¯”è¾ƒè¿ç®—ç¬¦ï¼ˆ>, <, >=, <=, ==, !=ï¼‰

2. **è§„åˆ™éªŒè¯å™¨**
   - è¯­æ³•æ£€æŸ¥
   - æŒ‡æ ‡å‚æ•°éªŒè¯

**å®ç°å»ºè®®**ï¼š
```python
# å‚è€ƒ QuantOL/src/core/strategy/rule_parser.py
class RuleParser:
    def parse(self, rule_expr):
        """è§£æè§„åˆ™è¡¨è¾¾å¼"""
        # è§£æ "MA(5) > MA(20) and RSI(14) < 30"
        pass
        
    def evaluate(self, rule_expr, data):
        """è¯„ä¼°è§„åˆ™è¡¨è¾¾å¼"""
        pass
```

#### 4.2.2 äº¤æ˜“æ‰§è¡Œæ¨¡å— â­â­â­
**å‚è€ƒé¡¹ç›®**: QuantOL, sphinx-quant

**éœ€è¦å®ç°çš„åŠŸèƒ½**ï¼š
1. **è®¢å•ç®¡ç†ç³»ç»Ÿ**
   - è®¢å•åˆ›å»º
   - è®¢å•çŠ¶æ€è·Ÿè¸ª
   - è®¢å•å–æ¶ˆ

2. **æˆäº¤å›æŠ¥**
   - æ¨¡æ‹Ÿæˆäº¤
   - æˆäº¤ç¡®è®¤

**å®ç°å»ºè®®**ï¼š
```python
class ExecutionEngine:
    def __init__(self, portfolio, risk_manager):
        self.portfolio = portfolio
        self.risk_manager = risk_manager
        self.orders = {}
        
    def submit_order(self, order):
        """æäº¤è®¢å•"""
        if self.risk_manager.validate_order(order):
            self.orders[order.id] = order
            return True
        return False
        
    def execute_order(self, order, current_price):
        """æ‰§è¡Œè®¢å•"""
        # æ¨¡æ‹Ÿæˆäº¤
        pass
```

#### 4.2.3 ç­–ç•¥å‚æ•°ä¼˜åŒ– â­â­â­
**å‚è€ƒé¡¹ç›®**: QuantOL

**éœ€è¦å®ç°çš„åŠŸèƒ½**ï¼š
1. **ç½‘æ ¼æœç´¢**
2. **éšæœºæœç´¢**
3. **è´å¶æ–¯ä¼˜åŒ–**

---

### 4.3 ä¼˜å…ˆçº§ P2ï¼ˆå¢å¼ºåŠŸèƒ½ï¼Œæœªæ¥å®Œæˆï¼‰

#### 4.3.1 å®ç›˜äº¤æ˜“æ¥å£ â­â­
**å‚è€ƒé¡¹ç›®**: sphinx-quant, OSkhQuant

**éœ€è¦å®ç°çš„åŠŸèƒ½**ï¼š
1. **åˆ¸å•†APIé€‚é…å™¨**
2. **å®ç›˜ä¸‹å•**
3. **å®ç›˜ç›‘æ§**

#### 4.3.2 æœºå™¨å­¦ä¹ ç­–ç•¥ â­â­
**å‚è€ƒé¡¹ç›®**: AShare-AI-Stock-Picker

**éœ€è¦å®ç°çš„åŠŸèƒ½**ï¼š
1. **ç‰¹å¾å·¥ç¨‹**
2. **æ¨¡å‹è®­ç»ƒ**
3. **æ¨¡å‹é¢„æµ‹**

---

## äº”ã€å®æ–½è·¯çº¿å›¾

### é˜¶æ®µä¸€ï¼šæ ¸å¿ƒé£æ§å’Œç»„åˆç®¡ç†ï¼ˆ2-3å‘¨ï¼‰
- [ ] å®Œå–„é£æ§æ¨¡å—ï¼ˆå‚è€ƒ QuantOLï¼‰
  - [ ] è®¢å•éªŒè¯æœºåˆ¶
  - [ ] é£é™©æŒ‡æ ‡ç›‘æ§
  - [ ] æ­¢æŸæ­¢ç›ˆæœºåˆ¶
- [ ] å®Œå–„æŠ•èµ„ç»„åˆæ¨¡å—ï¼ˆå‚è€ƒ QuantOLï¼‰
  - [ ] ç¼“å­˜ä¼˜åŒ–
  - [ ] FIFOæˆæœ¬è®¡ç®—
  - [ ] ç»„åˆå†å¹³è¡¡

### é˜¶æ®µäºŒï¼šæ•°æ®å’Œå›æµ‹æ‰©å±•ï¼ˆ2-3å‘¨ï¼‰
- [ ] å®Œå–„æ•°æ®æ¨¡å—ï¼ˆå‚è€ƒ QuantOL, qstockï¼‰
  - [ ] SQLite æŒä¹…åŒ–
  - [ ] å­—æ®µæ˜ å°„å™¨
  - [ ] æ•°æ®è´¨é‡æ£€æŸ¥
  - [ ] åŸºæœ¬é¢æ•°æ®æ¥å£
- [ ] æ‰©å±•å›æµ‹å¼•æ“ï¼ˆå‚è€ƒ QuantOLï¼‰
  - [ ] è®¢å•ç±»å‹æ‰©å±•
  - [ ] æ»‘ç‚¹æ¨¡æ‹Ÿæ‰©å±•
  - [ ] ç­–ç•¥å‚æ•°ä¼˜åŒ–

### é˜¶æ®µä¸‰ï¼šè§„åˆ™å¼•æ“å’Œæ‰§è¡Œï¼ˆ2-3å‘¨ï¼‰
- [ ] è§„åˆ™å¼•æ“ï¼ˆå‚è€ƒ QuantOLï¼‰
  - [ ] è¡¨è¾¾å¼è§£æå™¨
  - [ ] è§„åˆ™éªŒè¯å™¨
- [ ] äº¤æ˜“æ‰§è¡Œæ¨¡å—ï¼ˆå‚è€ƒ QuantOL, sphinx-quantï¼‰
  - [ ] è®¢å•ç®¡ç†ç³»ç»Ÿ
  - [ ] æˆäº¤å›æŠ¥æœºåˆ¶

### é˜¶æ®µå››ï¼šé«˜çº§åŠŸèƒ½ï¼ˆ3-4å‘¨ï¼‰
- [ ] å®ç›˜äº¤æ˜“æ¥å£ï¼ˆå‚è€ƒ sphinx-quant, OSkhQuantï¼‰
- [ ] æœºå™¨å­¦ä¹ ç­–ç•¥ï¼ˆå‚è€ƒ AShare-AI-Stock-Pickerï¼‰

---

## å…­ã€ä»£ç è´¨é‡ä¿è¯

### 6.1 æµ‹è¯•ç­–ç•¥
- **å•å…ƒæµ‹è¯•**ï¼šæ¯ä¸ªæ¨¡å—å¿…é¡»æœ‰å•å…ƒæµ‹è¯•
- **é›†æˆæµ‹è¯•**ï¼šæ¨¡å—é—´äº¤äº’æµ‹è¯•
- **å›æµ‹éªŒè¯**ï¼šä¸ç°æœ‰é¡¹ç›®å¯¹æ¯”éªŒè¯

### 6.2 ä»£ç å®¡æŸ¥
- **å‚è€ƒç°æœ‰é¡¹ç›®**ï¼šä¸¥æ ¼æŒ‰ç…§ QuantOL ç­‰é¡¹ç›®çš„ä»£ç é£æ ¼
- **é€æ­¥è¿­ä»£**ï¼šæ¯æ¬¡åªä¿®æ”¹ä¸€ä¸ªæ¨¡å—
- **å……åˆ†æµ‹è¯•**ï¼šæ¯æ¬¡ä¿®æ”¹åè¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶

### 6.3 æ–‡æ¡£
- **APIæ–‡æ¡£**ï¼šæ¯ä¸ªå…¬å…±æ–¹æ³•å¿…é¡»æœ‰æ–‡æ¡£å­—ç¬¦ä¸²
- **ä½¿ç”¨ç¤ºä¾‹**ï¼šæä¾›å®Œæ•´çš„ä½¿ç”¨ç¤ºä¾‹
- **æ¶æ„æ–‡æ¡£**ï¼šæ›´æ–°æ¶æ„è®¾è®¡æ–‡æ¡£

---

## ä¸ƒã€å…³é”®æ–‡ä»¶ç´¢å¼•

### 7.1 QuantOL å…³é”®æ–‡ä»¶
```
æ ¸å¿ƒç»„åˆç®¡ç†ï¼šsrc/core/portfolio/portfolio.py ï¼ˆ480è¡Œï¼‰
é£é™©ç®¡ç†ï¼šsrc/core/risk/risk_manager.py ï¼ˆ53è¡Œï¼‰
å›æµ‹å¼•æ“ï¼šsrc/core/strategy/backtesting.py ï¼ˆ1800+è¡Œï¼‰
è§„åˆ™è§£æå™¨ï¼šsrc/core/strategy/rule_parser.py ï¼ˆ1200+è¡Œï¼‰
æ•°æ®åº“é€‚é…å™¨ï¼šsrc/core/data/sqlite_adapter.py ï¼ˆ2100+è¡Œï¼‰
æ™ºèƒ½æ•°æ®ç®¡ç†ï¼šsrc/core/data/smart_data_manager.py ï¼ˆ600+è¡Œï¼‰
```

### 7.2 qstock å…³é”®æ–‡ä»¶
```
å‘é‡åŒ–å›æµ‹ï¼šbacktest/vec_backtest.py
æ•°æ®æ¥å£ï¼šdata/trade.py
åŸºæœ¬é¢æ•°æ®ï¼šdata/fundamental.py
```

### 7.3 OSkhQuant å…³é”®æ–‡ä»¶
```
ä¸»æ¡†æ¶ï¼škhFrame.py ï¼ˆ4700+è¡Œï¼‰
é£æ§ï¼škhRisk.py
äº¤æ˜“ï¼škhTrade.py ï¼ˆ830+è¡Œï¼‰
æŠ€æœ¯æŒ‡æ ‡ï¼šMyTT.pyï¼ˆä¸d-quant2çš„MyTTç±»ä¼¼ï¼‰
```

---

## å…«ã€æ€»ç»“

### 8.1 æ ¸å¿ƒå·®è·
d-quant2 å½“å‰å¤„äº **å›æµ‹åŸºç¡€é˜¶æ®µ**ï¼Œç›¸æ¯”æˆç†Ÿé¡¹ç›®ä¸»è¦å·®è·åœ¨ï¼š
1. **é£æ§æ¨¡å—ç¼ºå¤±** - æœ€å…³é”®çš„å·®è·
2. **æŠ•èµ„ç»„åˆç®¡ç†ç®€å•** - ç¼ºå°‘ç¼“å­˜ä¼˜åŒ–ã€å†å¹³è¡¡ç­‰
3. **æ•°æ®æŒä¹…åŒ–ç¼ºå¤±** - æ²¡æœ‰æ•°æ®åº“æ”¯æŒ
4. **äº¤æ˜“æ‰§è¡Œç¼ºå¤±** - ä»…æ”¯æŒå›æµ‹ï¼Œæ— å®ç›˜èƒ½åŠ›
5. **è§„åˆ™å¼•æ“ç¼ºå¤±** - ä¸æ”¯æŒDSLç­–ç•¥è¡¨è¾¾

### 8.2 ä¼˜åŠ¿
d-quant2 çš„ä¼˜åŠ¿åœ¨äºï¼š
1. **ä»£ç ç»“æ„æ¸…æ™°** - æ¨¡å—åŒ–è®¾è®¡è‰¯å¥½
2. **Streamlitç•Œé¢** - æ˜“ç”¨æ€§å¼º
3. **è‡ªå®šä¹‰ç­–ç•¥** - æ”¯æŒç­–ç•¥æ‰©å±•
4. **MyTTæŒ‡æ ‡** - å¼ºå¤§çš„æŠ€æœ¯æŒ‡æ ‡åº“

### 8.3 å»ºè®®
1. **ä¼˜å…ˆå®Œå–„é£æ§å’Œç»„åˆç®¡ç†** - è¿™æ˜¯é‡åŒ–ç³»ç»Ÿçš„æ ¸å¿ƒ
2. **å‚è€ƒ QuantOL çš„æ¶æ„** - å®ƒæ˜¯æœ€å®Œå–„çš„å¼€æºé¡¹ç›®
3. **æ¸è¿›å¼å¼€å‘** - æ¯æ¬¡åªæ·»åŠ ä¸€ä¸ªåŠŸèƒ½æ¨¡å—
4. **å……åˆ†æµ‹è¯•** - å›æµ‹ç»“æœå¿…é¡»ä¸å‚è€ƒé¡¹ç›®å¯¹æ¯”éªŒè¯
5. **ä¿æŒä»£ç è´¨é‡** - ä¸¥æ ¼éµå¾ªç°æœ‰é¡¹ç›®çš„ç¼–ç è§„èŒƒ

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2026-02-02
**æŠ¥å‘Šç‰ˆæœ¬**: v1.0
**å‚è€ƒé¡¹ç›®**: QuantOL, qstock, OSkhQuant, sphinx-quant
